
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n L√Ω Kh√≥a H·ªçc ‚Ä¢ JSON driven</title>

  <!-- ‚ñ∏ Styles & fonts -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- ‚ñ∏ Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>

  <style>
    /* ====== Theme Variables ====== */
    :root {
      --primary-color: #4f46e5;
      --primary-gradient: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
      --secondary-color: #64748b;
      --bg-primary: #ffffff;
      --bg-card: #ffffff;
      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-muted: #6b7280;
      --border-light: #ffffff;
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
      --radius-sm: 8px;
      --radius-md: 12px;
      --transition: all 0.2s ease;
    }

    /* ====== Global Styles ====== */
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Be Vietnam Pro', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.5;
      padding: 1.5rem;
      min-height: 100vh;
    }

    /* Desktop: Disable body scroll */
    @media (min-width: 1201px) {
      body {
        height: 100vh;
        overflow: hidden;
        padding: 1.5rem;
      }
    }

    /* ====== Layout Containers ====== */
    .app-container {
      max-width: 1400px;
      margin: 0 auto;
      background: var(--bg-card);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      /* B·ªè overflow: hidden ƒë·ªÉ sticky c√≥ th·ªÉ ho·∫°t ƒë·ªông */
    }

    /* Desktop: Full height app container */
    @media (min-width: 1201px) {
      .app-container {
        height: calc(100vh - 3rem); /* Subtract body padding */
        display: flex;
        flex-direction: column;
      }
    }

    .app-header {
      background: var(--primary-gradient);
      color: #fff;
      padding: 2rem;
      text-align: center;
      border-radius: var(--radius-md) var(--radius-md) 0 0;
      /* B·ªè sticky - cho ph√©p scroll qua */
    }
    .app-header h1 { font-size: 2rem; font-weight: 700; margin-bottom: .5rem; }
    .app-header .subtitle { opacity: .9; }

    .content-area { 
      padding: 0 2rem 2rem; 
      border-radius: var(--radius-md);
      background: var(--bg-card);
    }

    /* Desktop: Flexible content area */
    @media (min-width: 1201px) {
      .content-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        padding: 2rem;
      }
    }

    /* ====== Search ====== */
    .search-section { 
      /* Sticky positioning - ghim khi scroll */
      position: sticky;
      top: 0;
      z-index: 100;
      background: var(--bg-primary);
      padding: 1rem 2rem;
      margin: -2rem -2rem 2rem -2rem;
      /* Th√™m shadow ƒë·ªÉ t√°ch bi·ªát khi sticky */
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    /* Desktop: Static search section */
    @media (min-width: 1201px) {
      .search-section {
        position: static;
        background: transparent;
        padding: 0 0 1.5rem 0;
        margin: 0 0 1.5rem 0;
        box-shadow: none;
        flex-shrink: 0;
      }
    }
    .search-container { position: relative; max-width: 523333330px; }
    .search-input {
      width: 100%;
      padding: 0.875rem 1.25rem 0.875rem 3rem;
      border: 2px solid #e2e8f0;
      border-radius: 50px; /* Bo tr√≤n ho√†n to√†n */
      font-size: .95rem;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 1px 3px rgba(0, 0, 0, 0.06);
      background: #ffffff;
    }
    .search-input:focus { 
      outline: none; 
      border-color: var(--primary-color); 
      box-shadow: 0 4px 20px rgba(79, 70, 229, 0.15), 0 2px 8px rgba(79, 70, 229, 0.1);
      transform: translateY(-1px);
    }
    .search-input::placeholder {
      color: #9ca3af;
      font-weight: 400;
    }
    .search-icon { 
      position: absolute; 
      left: 1.125rem; 
      top: 50%; 
      transform: translateY(-50%); 
      color: var(--text-muted);
      font-size: 1rem;
    }

    /* ====== Table ====== */
    .table-container { 
      border-radius: var(--radius-sm); 
      box-shadow: var(--shadow-sm);
      position: relative;
      /* B·ªè overflow: hidden ƒë·ªÉ table headers c√≥ th·ªÉ sticky */
    }

    /* Desktop: Scrollable table container */
    @media (min-width: 1201px) {
      .desktop-table {
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      
      .table-container {
        flex: 1;
        overflow-y: auto;
        max-height: 100%;
      }
    }
    
    /* ====== DataTables wrapper fixes ====== */
    .dataTables_wrapper {
      position: relative;
    }
    
    .dataTables_scroll {
      position: relative;
    }
    
    .dataTables_scrollHead,
    .dataTables_scrollHeadInner {
      position: relative;
    }
    
    .dataTables_scrollBody {
      position: relative;
    }
    
    #courses { 
      width: 100%; 
      border-collapse: separate;
      border-spacing: 0;
    }
    
    #courses thead th {
      background: #2EC7BE; /* M√†u xanh ng·ªçc nh·∫°t */
      color: #fff;
      padding: 1rem;
      font-weight: 700; /* In ƒë·∫≠m */
      font-size: 18px;  /* TƒÉng c·ª° ch·ªØ */
      text-align: center;
      /* Sticky header - d√≠nh d∆∞·ªõi search bar */
      position: sticky;
      top: 80px; /* Chi·ªÅu cao c·ªßa search section */
      z-index: 50;
      /* Th√™m ƒë·ªÉ tr√°nh border issues */
      box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.4);
      border-bottom: 2px solid #178a7a; /* Vi·ªÅn ƒë·∫≠m h∆°n m·ªôt ch√∫t */
    }

    /* Desktop: Table header sticky within container */
    @media (min-width: 1201px) {
      #courses thead th {
        top: 0; /* Sticky to top of table container */
      }
    }
    #courses tbody td {
      padding: 1rem;
      border-bottom: 1px solid var(--border-light);
      color: #1D3F59; /* ƒê·ªïi m√†u ch·ªØ trong data table */
      text-align: center;
      font-size: 15px; /* Th√™m font-size cho n·ªôi dung table */
    }
    #courses tbody tr:hover { background: #f1f5f9; cursor: pointer; }

    .tuition { font-weight: 600; color: #177991; }

    /* ====== Mode Badges ====== */
    .mode-badge { padding: .4rem .8rem; border-radius: var(--radius-sm); font-size: .85rem; font-weight: 500; }
    .mode-badge.online  { background: rgba(45, 140, 255, 0.1); color: #2D8CFF; } /* M√†u xanh d∆∞∆°ng Zoom */
    .mode-badge.hybrid  { background: rgba(245,158,11,.1); color: #f59e0b; }
    .mode-badge.offline { background: rgba(32, 178, 170, 0.1); color: #2EC7BE; } /* M√†u xanh ng·ªçc nh·∫°t */

    /* ====== Mobile Cards ====== */
    .mobile-card-container { display: none; flex-direction: column; gap: 1.5rem; }
    .course-card { 
      border: 1px solid #e2e8f0; 
      border-radius: 12px; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.08); 
      overflow: hidden; 
      background: #fff;
      transition: var(--transition);
    }
    .course-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    }
    
    /* Fixed image container with proper aspect ratio */
    .card-thumbnail-container {
      position: relative;
      width: 100%;
      height: 0;
      padding-bottom: 56.9%; /* 164.5/288.99 * 100% ‚âà 56.9% */
      overflow: hidden;
      background: var(--primary-gradient);
    }
    .card-thumbnail {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .card-thumbnail-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
      text-align: center;
      padding: 1rem;
    }
    
    /* Card content now separate from image */
    .card-header {
      padding: 1.25rem 1.25rem 0;
    }
    .card-title {
      color: var(--text-primary);
      font-size: 1.1rem;
      font-weight: 600;
      margin: 0 0 1rem 0;
      line-height: 1.4;
    }
    
    .card-body { padding: 0 1.25rem 1.25rem; }
    .card-meta {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .card-mode-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
      text-transform: uppercase;
    }
    .card-mode-badge.online {
      background: rgba(45, 140, 255, 0.1); /* N·ªÅn xanh d∆∞∆°ng nh·∫°t cho Zoom */
      color: #2D8CFF; /* M√†u xanh d∆∞∆°ng Zoom */
    }
    .card-mode-badge.offline {
      background: rgba(32, 178, 170, 0.1); /* N·ªÅn xanh ng·ªçc nh·∫°t */
      color: #2EC7BE; /* M√†u xanh ng·ªçc nh·∫°t */
    }
    .card-mode-badge.hybrid {
      background: #fef3c7;
      color: #92400e;
    }
    
    .card-info-grid {
      display: grid;
      gap: 0.75rem;
      margin-bottom: 1.25rem;
    }
    .card-info-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    .card-info-item .info-icon {
      color: var(--primary-color);
      width: 16px;
      text-align: center;
    }
    .card-info-item .info-value {
      color: var(--text-primary);
      font-weight: 500;
    }
    
    .card-price {
      font-size: 1.25rem;
      font-weight: 700;
      color: #dc2626;
      margin-bottom: 1rem;
    }
    
    .card-description {
      color: var(--text-secondary);
      font-size: 0.9rem;
      line-height: 1.5;
      margin-bottom: 1.25rem;
      word-wrap: break-word;
      hyphens: auto;
    }
    
    .card-footer { 
      padding: 0 1.25rem 1.25rem; 
      display: flex;
      gap: 0.75rem;
    }
    .card-register-btn { 
      flex: 1;
      background: #16a34a; 
      color: #fff; 
      padding: 0.75rem 1rem; 
      border-radius: 8px; 
      text-decoration: none; 
      font-weight: 600; 
      transition: var(--transition);
      text-align: center;
      font-size: 0.9rem;
    }
    .card-register-btn:hover { 
      background: #15803d; 
      transform: translateY(-1px);
    }
    .card-details-btn { 
      background: transparent; 
      color: var(--primary-color); 
      padding: 0.75rem 1rem; 
      border: 1px solid var(--primary-color);
      border-radius: 8px; 
      text-decoration: none; 
      font-weight: 500; 
      transition: var(--transition);
      font-size: 0.9rem;
    }
    .card-details-btn:hover { 
      background: var(--primary-color);
      color: #fff;
    }

    /* ====== Phone link ====== */
    .phone-link { color: var(--primary-color); margin-left: .5rem; text-decoration: none; }

    /* ====== DataTables elements ====== */
    .dataTables_wrapper {
      position: relative;
    }
    
    .dataTables_wrapper .dataTables_length,
    .dataTables_wrapper .dataTables_info,
    .dataTables_wrapper .dataTables_paginate {
      color: var(--text-secondary);
      font-size: .85rem;
    }
    .dataTables_wrapper .dataTables_paginate .paginate_button { border: 1px solid var(--border-light); border-radius: var(--radius-sm); margin: 0 .25rem; }
    .dataTables_wrapper .dataTables_paginate .paginate_button:hover { background: var(--primary-color); color: #fff !important; }
    
    /* ====== Fix DataTables scroll containers ====== */
    .dataTables_scrollHead {
      position: sticky;
      top: 80px;
      z-index: 45;
      background: #fff;
    }

    /* Desktop: DataTables scroll head within container */
    @media (min-width: 1201px) {
      .dataTables_scrollHead {
        top: 0;
      }
    }
    
    .dataTables_scrollHeadInner {
      position: relative;
      width: 100% !important;
    }
    
    .dataTables_scrollHeadInner table {
      margin-bottom: 0 !important;
    }

    /* ====== Responsive tweaks ====== */
    @media (max-width: 1200px) { 
      .desktop-table { display: none; } 
      .mobile-card-container { display: flex; }
      /* ƒêi·ªÅu ch·ªânh search section cho mobile */
      .search-section {
        padding: 0.75rem 1rem;
        margin: -1rem -1rem 1.5rem -1rem;
      }
      #courses thead th {
        top: 70px; /* Gi·∫£m cho mobile */
      }
      .dataTables_scrollHead {
        top: 70px;
      }
    }
    @media (max-width: 768px)  { 
      body { padding: 1rem; } 
      .content-area { padding: 1rem; }
      .app-header { padding: 1.5rem; }
      .search-section {
        padding: 0.75rem 1rem;
        margin: -1rem -1rem 1.5rem -1rem;
      }
      #courses thead th {
        top: 65px; /* Gi·∫£m cho mobile */
      }
      .dataTables_scrollHead {
        top: 65px;
      }
    }
    @media (max-width: 480px)  { 
      .app-header h1 { font-size: 1.5rem; } 
      .app-header .subtitle { font-size: .9rem; }
      .app-header { padding: 1.25rem; }
      .card-footer {
        flex-direction: column;
      }
      .card-register-btn, .card-details-btn {
        text-align: center;
      }
      .search-input {
        padding: 0.75rem 1rem 0.75rem 2.75rem;
      }
      .search-icon {
        left: 1rem;
      }
      #courses thead th {
        top: 60px; /* Gi·∫£m h∆°n cho mobile nh·ªè */
      }
      .dataTables_scrollHead {
        top: 60px;
      }
    }

    /* ====== Special Course Highlight ====== */
    .card-title.special-course-highlight,
    .upcoming-tile a.special-course-highlight,
    #courses tbody td.special-course-highlight {
      color: #dc2626 !important;
      font-weight: 700 !important;
    }

    /* ====== Upcoming desktop tiles ====== */
    .upcoming-carousel-wrapper {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1.25rem;
      position: relative;
      width: 100%;
      margin: 0 auto 2rem auto;
    }

    /* Desktop: Static highlights */
    @media (min-width: 1201px) {
      .upcoming-carousel-wrapper {
        flex-shrink: 0;
        margin-bottom: 1.5rem;
      }
    }

    .upcoming-tile {
      border-radius: 12px;
      color: #fff;
      padding: 1rem 1.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
      position: relative;
      overflow: hidden;
    }

    @media (max-width: 1200px) {
      .upcoming-carousel-wrapper { display: none; }
    }

    .upcoming-tile h3{
      font-size:18px;
      font-weight:700;
      margin:0 0 .75rem 0;
      text-align:center;
      line-height: 1.3; /* Th√™m ƒë·ªÉ ti√™u ƒë·ªÅ d√†i hi·ªÉn th·ªã t·ªët h∆°n */
    }
    .upcoming-tile .tile-divider{
      position:absolute;
      top:46px;
      left:0;
      width:100%;
      height:2px;
      background:rgba(255,255,255,.5);
    }
    .upcoming-tile ul{
      list-style:none;
      margin:0;
      padding:.5rem 0 0 0;
      font-size:.95rem; /* TƒÉng k√≠ch th∆∞·ªõc n·ªôi dung */
      line-height:1.4;
      max-height:180px; 
      overflow:auto;
      /* Custom scrollbar styles */
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,.3) transparent;
    }
    /* Webkit scrollbar styles */
    .upcoming-tile ul::-webkit-scrollbar {
      width: 6px;
    }
    .upcoming-tile ul::-webkit-scrollbar-track {
      background: transparent;
    }
    .upcoming-tile ul::-webkit-scrollbar-thumb {
      background-color: rgba(255,255,255,.3);
      border-radius: 3px;
    }
    .upcoming-tile ul::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255,255,255,.5);
    }
    .upcoming-tile li+li{margin-top:.5rem;padding-top:.5rem;border-top:1px solid rgba(255,255,255,.25);}    

    /* Tile theme colors */
    #tile-hcm    {background:#FFFBEC;} /* v√†ng si√™u nh·∫°t */
    #tile-hn     {background:#E3FFFF;} /* Light Cyan */
    #tile-other  {background:#FFEBFC;} /* h·ªìng si√™u nh·∫°t */
    #tile-online {background:#3b82f6;} /* zoom blue */

    /* Override special course color for Online tile to be white */
    #tile-online .special-course-highlight {
      color: #fff !important;
    }

    /* Custom styles for HN tile due to light background */
    #tile-hn,
    #tile-hn h3,
    #tile-hn .course-name,
    #tile-hn .course-date,
    #tile-hn .course-location {
      color: #398398; /* New color as requested */
    }

    #tile-hn .tile-divider {
      background: rgba(57, 131, 152, 0.2);
    }

    #tile-hn li+li {
      border-top-color: rgba(57, 131, 152, 0.6);
    }

    #tile-hn .course-name:hover {
      opacity: 0.7;
    }

    #tile-hn ul {
      scrollbar-color: rgba(57, 131, 152, 0.6) transparent;
    }
    #tile-hn ul::-webkit-scrollbar-thumb {
      background-color: rgba(57, 131, 152, 0.6);
    }
    #tile-hn ul::-webkit-scrollbar-thumb:hover {
      background-color: rgba(57, 131, 152, 0.6);
    }

    .upcoming-tile ul li{
      display:flex;
      justify-content:space-between;
      gap:.5rem;
      align-items:baseline;
    }
    .upcoming-tile .course-name{
      flex:1;
      word-break:break-word;
      color: #fff;
      text-decoration: none;
      transition: opacity 0.2s ease;
      font-size: 15px;
    }
    .upcoming-tile .course-name:hover {
      opacity: 0.8;
    }
    .upcoming-tile .course-date{
      white-space:nowrap;
      font-size: 15px;
    }
    .upcoming-tile .course-title-group {
      flex: 1; /* Group (name+loc) will take available space */
    }

    .upcoming-tile .course-title-group .course-name {
      flex: none; /* Reset flex property for course-name inside the group */
    }

    .upcoming-tile .course-location{
      display: inline-block;
      font-size: 15px;
      color: rgba(255, 255, 255, 0.8);
      margin-left: 0.4rem;
      vertical-align: baseline;
    }

    /* Custom styles for HCM tile due to light background */
    #tile-hcm,
    #tile-hcm h3,
    #tile-hcm .course-name,
    #tile-hcm .course-date,
    #tile-hcm .course-location {
      color: #1D3F59;
    }

    #tile-hcm .tile-divider {
      background: rgba(29, 63, 89, 0.1);
    }

    #tile-hcm li+li {
      border-top-color: rgba(29, 63, 89, 0.15);
    }

    #tile-hcm .course-name:hover {
      opacity: 0.7;
    }

    #tile-hcm ul {
      scrollbar-color: rgba(29, 63, 89, 0.25) transparent;
    }
    #tile-hcm ul::-webkit-scrollbar-thumb {
      background-color: rgba(29, 63, 89, 0.25);
    }
    #tile-hcm ul::-webkit-scrollbar-thumb:hover {
      background-color: rgba(29, 63, 89, 0.4);
    }

    /* Custom styles for Other tile */
    #tile-other,
    #tile-other h3,
    #tile-other .course-name,
    #tile-other .course-date,
    #tile-other .course-location {
      color: #1D3F59;
    }

    #tile-other .tile-divider {
      background: rgba(29, 63, 89, 0.1);
    }

    #tile-other li+li {
      border-top-color: rgba(29, 63, 89, 0.25);
    }

    #tile-other .course-name:hover {
      opacity: 0.8;
    }

    #tile-other ul {
      scrollbar-color: rgba(29, 63, 89, 0.3) transparent;
    }
    #tile-other ul::-webkit-scrollbar-thumb {
      background-color: rgba(29, 63, 89, 0.3);
    }
    #tile-other ul::-webkit-scrollbar-thumb:hover {
      background-color: rgba(29, 63, 89, 0.5);
    }

    /* ====== Mobile Custom Scrollbar ====== */
    @media (max-width: 1200px) {
      /* Custom scrollbar cho mobile container */
      body {
        scrollbar-width: thin;
        scrollbar-color: rgba(79, 70, 229, 0.4) transparent;
      }
      
      body::-webkit-scrollbar {
        width: 8px;
      }
      
      body::-webkit-scrollbar-track {
        background: transparent;
      }
      
      body::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, rgba(79, 70, 229, 0.6) 0%, rgba(124, 58, 237, 0.6) 100%);
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      
      body::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, rgba(79, 70, 229, 0.8) 0%, rgba(124, 58, 237, 0.8) 100%);
      }
    }

    /* ====== Mobile Scroll Indicator ====== */
    .mobile-scroll-indicator {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(46, 199, 190, 0.7); /* M√†u xanh ng·ªçc nh·∫°t v·ªõi opacity 70% */
      color: white;
      padding: 12px 16px;
      border-radius: 50px;
      box-shadow: 0 4px 20px rgba(46, 199, 190, 0.2);
      display: none; /* Hidden by default */
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
      z-index: 1000;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      max-width: calc(100vw - 40px);
    }

    .mobile-scroll-indicator.visible {
      display: flex;
      animation: slideInUp 0.4s ease-out;
    }

    .mobile-scroll-indicator.hiding {
      animation: slideOutDown 0.3s ease-in forwards;
    }

    .mobile-scroll-indicator-icon {
      font-size: 16px;
      animation: bounce 2s infinite;
    }

    .mobile-scroll-indicator-text {
      white-space: nowrap;
      font-family: 'Be Vietnam Pro', sans-serif;
    }

    /* Animations */
    @keyframes slideInUp {
      from {
        transform: translateX(-50%) translateY(100%);
        opacity: 0;
      }
      to {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }
    }

    @keyframes slideOutDown {
      from {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }
      to {
        transform: translateX(-50%) translateY(100%);
        opacity: 0;
      }
    }

    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
      }
      40% {
        transform: translateY(-4px);
      }
      60% {
        transform: translateY(-2px);
      }
    }

    /* Responsive adjustments for smaller screens */
    @media (max-width: 768px) {
      .mobile-scroll-indicator {
        bottom: 16px;
        padding: 10px 14px;
        font-size: 13px;
      }
    }

    @media (max-width: 480px) {
      .mobile-scroll-indicator {
        bottom: 12px;
        padding: 8px 12px;
        border-radius: 40px;
        font-size: 12px;
      }
    }

    /* Hide text only on very small screens (‚â§250px) */
    @media (max-width: 250px) {
      .mobile-scroll-indicator-text {
        display: none; /* Hide text on extremely small screens, keep only icon */
      }
      
      .mobile-scroll-indicator {
        padding: 6px 10px;
        border-radius: 30px;
      }
    }

    /* Hide scroll indicator on desktop */
    @media (min-width: 1201px) {
      .mobile-scroll-indicator {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">

    <main class="content-area">
      <!-- ‚ñ∏ Desktop upcoming highlight -->
      <section id="desktopHighlights" class="upcoming-carousel-wrapper"></section>

      <!-- ‚ñ∏ Search -->
      <section class="search-section">
        <div class="search-container">
          <i class="fas fa-search search-icon"></i>
          <input id="globalSearch" class="search-input"
                 placeholder="T√¨m ki·∫øm th√¥ng tin kh√≥a h·ªçc, gi·∫£ng vi√™n, ƒë·ªãa ƒëi·ªÉm..."
                 autocomplete="off">
        </div>
      </section>

      <!-- ‚ñ∏ Desktop table -->
      <div class="desktop-table">
        <div class="table-container">
          <table id="courses" class="display nowrap">
            <thead>
              <tr>
                <th>KH√ìA H·ªåC</th>
                <th>GI·∫¢NG VI√äN</th>
                <th>TH·ªúI GIAN</th>
                <th>ƒê·ªäA ƒêI·ªÇM</th>
                <th>H√åNH TH·ª®C</th>
                <!-- <th>H·ªçc ph√≠</th> -->
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- ‚ñ∏ Mobile cards -->
      <div id="mobileCardContainer" class="mobile-card-container"></div>
    </main>
  </div>

  <!-- ‚ñ∏ Mobile Scroll Indicator -->
  <div id="mobileScrollIndicator" class="mobile-scroll-indicator">
    <i class="fas fa-chevron-down mobile-scroll-indicator-icon"></i>
    <span class="mobile-scroll-indicator-text">Vu·ªët ƒë·ªÉ xem th√™m</span>
  </div>

<script>
  const specialCourses = ["Ch√°nh Ki·∫øn 1", "Nh√¢n T∆∞·ªõng H·ªçc", "R√®n Tr√≠ S√°ng Su·ªët", "R√®n T√¢m V·ªØng V√†ng"];

  /* ========================================================================
   *  Helper: b·ªè d·∫•u ti·∫øng Vi·ªát & lo·∫°i k√Ω t·ª± ƒë·∫∑c bi·ªát
   * ======================================================================*/
  const stripVN = str =>
    (str || '')
      .toString()
      .normalize('NFD')                // t√°ch d·∫•u
      .replace(/[\u0300-\u036f]/g, '') // b·ªè d·∫•u
      .replace(/ƒë/g, 'd').replace(/ƒê/g, 'D')
      .replace(/[^\w\s]/g, '')         // b·ªè k√Ω t·ª± l·∫° (‚Ç´, ., , ...)
      .toLowerCase();

  const VND = n => {
    if (typeof n === 'string') return n; // Handle "Li√™n h·ªá", "Mi·ªÖn ph√≠", etc.
    return (n || 0).toLocaleString('vi-VN') + ' vnƒë';
  };
  const parseNum = t => {
    const num = parseInt(String(t).replace(/[^\d]/g, '')) || 0;
    // Keep original string if it's not a standard number
    if (typeof t === 'string' && !/^\d+(\.\d{3})*$/.test(t.replace(/\D/g, ''))) {
      return t;
    }
    return num;
  };


  const createModeBadge = mode => {
    const online = /online|zoom|tr·ª±c tuy·∫øn/i.test(mode);
    const hybrid = /hybrid|k·∫øt h·ª£p/i.test(mode);
    let cls, icon;
    if (online)      [cls, icon] = ['online',  'fa-video'];
    else if (hybrid) [cls, icon] = ['hybrid',  'fa-people-arrows'];
    else             [cls, icon] = ['offline', 'fa-chalkboard-teacher'];
    return `<span class="mode-badge ${cls}"><i class="fas ${icon}"></i> ${mode || '?'}</span>`;
  };

  /* ====== Custom sort for DD/MM/YYYY & VND ====== */
  $.fn.dataTable.ext.type.order['ddmmyyyy-pre'] = d => {
    if (!d || d.includes('--')) return 0;
    const [dd, mm, yyyy] = d.split('/') || [];
    return new Date(yyyy, mm - 1, dd).getTime() || 0;
  };
  $.fn.dataTable.ext.type.order['vnd-pre'] = t => typeof t === 'string' ? 0 : parseNum(t); // Treat non-numeric fees as 0 for sorting

  /* ----------------------------------------------------------------------
   *  üîç  Accent-insensitive, number-friendly SEARCH plug-in
   * -------------------------------------------------------------------- */
  $.fn.dataTable.ext.search.push((settings, data, dataIndex, rowData) => {
    const query = stripVN($('#globalSearch').val().trim().toLowerCase());
    if (!query) return true;

    // Ki·ªÉm tra t·ª´ng c·ªôt c·ªßa d·ªØ li·ªáu g·ªëc
    // rowData ·ªü ƒë√¢y ƒë√£ ·ªü ƒë·ªãnh d·∫°ng cu·ªëi c√πng (start, end, speaker, course, etc.)
    return Object.values(rowData).some(val => {
      // N·∫øu l√† h·ªçc ph√≠ d·∫°ng string ("Li√™n h·ªá", "Mi·ªÖn ph√≠"), v·∫´n t√¨m ki·∫øm tr√™n chu·ªói ƒë√≥
      if (typeof val === 'string' && (val === 'Li√™n h·ªá' || val === 'Mi·ªÖn ph√≠' || val === 'T√ôY H·ª∂')) {
        return stripVN(val).includes(query);
      }
      if (typeof val === 'number') {
        // X·ª≠ l√Ω s·ªë ti·ªÅn (fee)
        return stripVN(VND(val)).includes(query) || String(val).includes(query);
      }
      // X·ª≠ l√Ω chu·ªói (bao g·ªìm HTML)
      const text = typeof val === 'string' ? val : String(val);
      return stripVN($('<div>').html(text).text()).includes(query);
    });
  });

  /* ========================================================================
   *  Data fetching
   * ======================================================================*/
  async function getData() {
    try {
      const res = await fetch('https://webhook.gnh.vn/webhook/event_info', { cache: 'no-store' });
      if (!res.ok) throw new Error(res.status);
      const raw = await res.json(); // raw is an array of objects from the webhook

      return raw
        .filter(x => x.course && x.speaker) // Keep this filter for API data
        .map(x => {
          let processedFee;
          // Use 'tuition' from API directly, as it's the expected field
          if (x.tuition === "Li√™n h·ªá" || x.tuition === "li√™n h·ªá" || x.tuition === "MI·ªÑN PH√ç" || x.tuition === "T√ôY H·ª∂") {
            processedFee = x.tuition; // Keep as string for these special cases
          } else if (!x.tuition || x.tuition === "" || x.tuition === null) {
            processedFee = "--";
          } else {
            processedFee = parseNum(x.tuition); // Parse number for numeric values
          }

          // Assume x.href is the primary link from the API for the main object
          // If the API provided specific fields like 'Chi ti·∫øt (link)' or 'ƒêƒÉng k√Ω (link)'
          // they would need to be handled here. For now, sticking to x.href as the main one.
          const finalHref = x.href || '#';

          return {
            start: x.start_date || '--/--/----',
            end: x.end_date || '--/--/----',
            speaker: x.speaker,
            course: x.course,
            loc: x.location || 'N/A',
            mode: x.learning_mode || 'N/A',
            fee: processedFee,
            href: finalHref,
            thumbnail: x.thumbnail || '',
            description: x.description || '',
            categories: x.categories || ''
          };
        });
    } catch (err) {
      console.warn('API l·ªói, d√πng d·ªØ li·ªáu d·ª± ph√≤ng:', err);
      // D·ªØ li·ªáu d·ª± ph√≤ng ƒë√£ ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi S·∫¥N sang ƒë·ªãnh d·∫°ng mong mu·ªën
      // (start, end, speaker, course, loc, mode, fee, href, thumbnail, description, categories)
      return [
        {
          start: '03/08/2025', end: '03/08/2025', speaker: 'Coach Th·∫Øng Huy·ªÅn ƒê·ª©c', course: 'Workshop ƒê·ªôi ng≈©', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 'Li√™n h·ªá', href: 'https://bke.edu.vn/wsthucchien', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/screenshot_1739867654-20250218083501-wdo7_.png', description: 'Workshop 1 ng√†y Th·ª±c chi·∫øn t·∫°i H√† N·ªôi - HCM - D√†nh cho ch·ªß doanh nghi·ªáp v√† ƒë·ªôi ng≈©'
        },
        {
          start: '16/08/2025', end: '17/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 1', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 1900000, href: 'https://bke.edu.vn/chanhkien1', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/ck1-banner-01-20220602030602.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        },
        {
          start: '27/09/2025', end: '28/09/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 2', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 2900000, href: 'https://bke.edu.vn/chanhkien2', thumbnail: 'https://w.ladicdn.com/s292x164/5e8449c2481e7d0f79868b5d/ck2-01-20220214103634.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        },
        {
          start: '02/07/2025', end: '02/07/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Thu·∫≠t d·ª•ng nh√¢n', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 499000, href: 'https://bke.edu.vn/dungnhan', thumbnail: '', description: ''
        },
        {
          start: '16/07/2025', end: '16/07/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Thu·∫≠t d·ª•ng nh√¢n', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 499000, href: 'https://bke.edu.vn/dungnhan', thumbnail: '', description: ''
        },
        {
          start: '08/07/2025', end: '10/07/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Th·∫•u hi·ªÉu nh√¢n t√¢m', loc: 'Zoom', mode: 'Zoom', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 399000, href: 'https://bke.edu.vn/nhantam/', thumbnail: '', description: ''
        },
        {
          start: '05/07/2025', end: '09/07/2025', speaker: 'C√¥ Nguy·ªÖn ƒêo√†n Kim S∆°n', course: 'L√£nh ƒë·∫°o ch√≠nh m√¨nh', loc: 'Zoom', mode: 'Zoom', categories: 'L√£nh ƒë·∫°o ch√≠nh m√¨nh - T·ªânh th·ª©c', fee: 1500000, href: 'https://gnh.vn/LDCM_K32', thumbnail: '', description: ''
        },
        {
          start: '21/09/2025', end: '21/09/2025', speaker: 'Coach Th·∫Øng Huy·ªÅn ƒê·ª©c', course: 'Leader 10x', loc: 'Zoom', mode: 'Zoom', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 30000000, href: 'https://bke.edu.vn/10x', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/leader-10x-20250512041107-go4gq.png', description: 'H√†nh tr√¨nh chuy·ªÉn h√≥a 10 tu·∫ßn ƒë·ªÉ kh√°m ph√° v√† l√£nh ƒë·∫°o ch√≠nh b·∫£n th√¢n, gi·∫£i ph√≥ng ni·ªÅm tin gi·ªõi h·∫°n, x√¢y d·ª±ng m√¥i tr∆∞·ªùng s·ªëng t√≠ch c·ª±c, v√† s·ªëng cu·ªôc ƒë·ªùi √Ω nghƒ©a.'
        },
        {
          start: '04/10/2025', end: '05/10/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Nh√¢n T∆∞·ªõng H·ªçc', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'ƒê·ªçc v·ªã Gi·∫£i m√£ s·ª± nghi·ªáp', fee: 6900000, href: 'https://bke.edu.vn/nhantuong', thumbnail: 'https://w.ladicdn.com/s289x164/5e8449c2481e7d0f79868b5d/banner-01-20220214044916.jpg', description: 'Gi√∫p b·∫°n soi m√¨nh, hi·ªÉu m√¨nh v√† s·ª≠a m√¨nh. Gi√∫p b·∫°n nh√¨n ng∆∞·ªùi, hi·ªÉu ng∆∞·ªùi & gi√∫p ng∆∞·ªùi'
        },
        {
          start: '30/07/2025', end: '30/07/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Th·∫•u hi·ªÉu nh√¢n t√¢m', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'ƒê·ªçc v·ªã Gi·∫£i m√£ s·ª± nghi·ªáp', fee: 499000, href: 'https://bke.edu.vn/nhantamoff', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/share-web-01-20221214070703-rnux3.jpg', description: ''
        },
        {
          start: '13/08/2025', end: '13/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Th·∫•u hi·ªÉu nh√¢n t√¢m', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'ƒê·ªçc v·ªã Gi·∫£i m√£ s·ª± nghi·ªáp', fee: 499000, href: 'https://bke.edu.vn/nhantamoff', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/share-web-01-20221214070703-rnux3.jpg', description: ''
        },
        {
          start: '11/10/2025', end: '12/10/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'X√¢y D·ª±ng ƒê·ªôi Ng≈©', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 6900000, href: 'https://bke.edu.vn/team', thumbnail: 'https://w.ladicdn.com/s292x164/5e8449c2481e7d0f79868b5d/team-20241016055944-_2iwu.png', description: 'M·ªôt DN m·∫°nh kh√¥ng c·∫ßn nh·ªØng con ng∆∞·ªùi r·ªùi r·∫°c. M·ªôt doanh nghi·ªáp m·∫°nh c·∫ßn m·ªôt ƒë·ªôi ng≈© m·∫°nh & g·∫Øn k·∫øt'
        },
        {
          start: '18/10/2025', end: '19/10/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Nh√¢n T∆∞·ªõng H·ªçc', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'ƒê·ªçc v·ªã Gi·∫£i m√£ s·ª± nghi·ªáp', fee: 6900000, href: 'https://bke.edu.vn/nhantuong', thumbnail: 'https://w.ladicdn.com/s289x164/5e8449c2481e7d0f79868b5d/banner-01-20220214044916.jpg', description: 'Gi√∫p b·∫°n soi m√¨nh, hi·ªÉu m√¨nh v√† s·ª≠a m√¨nh. Gi√∫p b·∫°n nh√¨n ng∆∞·ªùi, hi·ªÉu ng∆∞·ªùi & gi√∫p ng∆∞·ªùi'
        },
        {
          start: '08/09/2025', end: '31/10/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh ki·∫øn H·ªçc Hi·ªÉu H√†nh', loc: 'Zoom', mode: 'Zoom', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 3200000, href: 'https://bke.edu.vn/ck3h', thumbnail: 'https://w.ladicdn.com/s289x162/5e8449c2481e7d0f79868b5d/z5688760085770_7376ba05524391bcdec81d8e64a63e74-20240801072109-tv3h7.jpg', description: 'N·∫Øm tr·ªçn v·∫πn b√≠ quy·∫øt ƒë∆∞·ª£c th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n ƒë√∫c k·∫øt su·ªët 25 nƒÉm Th·ª±c H√†nh Chuy·ªÉn H√≥a ngay t·∫°i l·ªõp'
        },
        {
          start: '31/07/2025', end: '31/07/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Gieo duy√™n c·ªông ƒë·ªìng', loc: 'H√† Tƒ©nh', mode: 'Offline', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 'Mi·ªÖn ph√≠', href: 'https://zalo.me/g/uarrqk708', thumbnail: '', description: ''
        },
        {
          start: '01/08/2025', end: '01/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Gieo duy√™n c·ªông ƒë·ªìng', loc: 'Thanh H√≥a', mode: 'Offline', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 'Mi·ªÖn ph√≠', href: 'https://zalo.me/g/dslhif627', thumbnail: '', description: ''
        },
        {
          start: '05/08/2025', end: '07/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Th·∫•u hi·ªÉu nh√¢n t√¢m (T·ªëi)', loc: 'Zoom', mode: 'Zoom', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 399000, href: 'https://bke.edu.vn/nhantam/', thumbnail: '', description: ''
        },
        {
          start: '26/08/2025', end: '28/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Th·∫•u hi·ªÉu nh√¢n t√¢m (S√°ng)', loc: 'Zoom', mode: 'Zoom', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 399000, href: 'https://bke.edu.vn/nhantam/', thumbnail: '', description: ''
        },
        {
          start: '11/08/2025', end: '11/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Gieo duy√™n c·ªông ƒë·ªìng', loc: 'Qu·∫£ng Tr·ªã', mode: 'Offline', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 'Mi·ªÖn ph√≠', href: 'https://ybai.co/gjwdvp5847', thumbnail: '', description: ''
        },
        {
          start: '06/09/2025', end: '07/09/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 1', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 1900000, href: 'https://bke.edu.vn/chanhkien1', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/ck1-banner-01-20220602030602.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        },
        {
          start: '09/08/2025', end: '10/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ng√†y h·ªôi Gi√°o vi√™n 3 g·ªëc', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 500000, href: 'https://bke.edu.vn/giaovien3goc', thumbnail: '', description: ''
        },
        {
          start: '23/08/2025', end: '24/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ng√†y h·ªôi Gi√°o vi√™n 3 g·ªëc', loc: 'Vabis V≈©ng T√†u', mode: 'Offline', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 500000, href: 'https://bke.edu.vn/giaovien3goc', thumbnail: '', description: ''
        },
        {
          start: '25/10/2025', end: '26/10/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n - NSKT', course: 'X√¢y D·ª±ng ƒê·ªôi Ng≈©', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 6900000, href: 'https://bke.edu.vn/team', thumbnail: 'https://w.ladicdn.com/s292x164/5e8449c2481e7d0f79868b5d/team-20241016055944-_2iwu.png', description: 'M·ªôt DN m·∫°nh kh√¥ng c·∫ßn nh·ªØng con ng∆∞·ªùi r·ªùi r·∫°c. M·ªôt doanh nghi·ªáp m·∫°nh c·∫ßn m·ªôt ƒë·ªôi ng≈© m·∫°nh & g·∫Øn k·∫øt'
        },
        {
          start: '19/08/2025', end: '21/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Th·∫•u hi·ªÉu nh√¢n t√¢m (T·ªëi)', loc: 'Zoom', mode: 'Zoom', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 399000, href: 'https://bke.edu.vn/nhantam/', thumbnail: '', description: ''
        },
        {
          start: '12/08/2025', end: '14/08/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'B√≠ m·∫≠t t√¨nh y√™u h√¥n nh√¢n (T·ªëi)', loc: 'Zoom', mode: 'Zoom', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 'MI·ªÑN PH√ç', href: 'https://bke.edu.vn/honnhanbenvung/', thumbnail: '', description: ''
        },
        {
          start: '20/09/2025', end: '21/09/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 1', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 1900000, href: 'https://bke.edu.vn/chanhkien1', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/ck1-banner-01-20220602030602.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        },
        {
          start: '09/09/2025', end: '11/09/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'B√≠ m·∫≠t t√¨nh y√™u h√¥n nh√¢n (T·ªëi)', loc: 'Zoom', mode: 'Zoom', categories: 'L·ªõp h·ªçc Gieo duy√™n c·ªông ƒë·ªìng', fee: 'MI·ªÑN PH√ç', href: 'https://bke.edu.vn/honnhanbenvung/', thumbnail: '', description: ''
        },
        {
          start: '17/09/2025', end: '17/09/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Gieo duy√™n c·ªông ƒë·ªìng', loc: 'ƒê√† N·∫µng', mode: 'Offline', categories: 'D·∫°y con', fee: 'MI·ªÑN PH√ç', href: 'https://gnh.vn/dayconthanhtai-danang', thumbnail: '', description: ''
        },
        {
          start: '18/09/2025', end: '18/09/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Gieo duy√™n c·ªông ƒë·ªìng', loc: 'ƒê√† N·∫µng', mode: 'Offline', categories: 'H√†nh tr√¨nh Doanh nghi·ªáp', fee: 'T√ôY H·ª∂', href: 'https://gnh.vn/Dky_LanhDaoTinhThuc', thumbnail: '', description: ''
        },
        {
          start: '08/11/2025', end: '09/11/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 1', loc: 'H√† N·ªôi', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 1900000, href: 'https://bke.edu.vn/chanhkien1', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/ck1-banner-01-20220602030602.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        },
        {
          start: '13/12/2025', end: '14/12/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 2', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 2900000, href: 'https://bke.edu.vn/chanhkien2', thumbnail: 'https://w.ladicdn.com/s292x164/5e8449c2481e7d0f79868b5d/ck2-01-20220214103634.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        },
        {
          start: '22/11/2025', end: '23/11/2025', speaker: 'Th·∫ßy Tr·∫ßn Vi·ªát Qu√¢n', course: 'Ch√°nh Ki·∫øn 1', loc: 'H·ªì Ch√≠ Minh', mode: 'Offline', categories: 'H√†nh tr√¨nh 3 G·ªëc', fee: 1900000, href: 'https://bke.edu.vn/chanhkien1', thumbnail: 'https://w.ladicdn.com/5e8449c2481e7d0f79868b5d/ck1-banner-01-20220602030602.jpg', description: 'H√†nh tr√¨nh 2 ng√†y ƒë√™m gi√∫p b·∫°n hi·ªÉu s√¢u ph∆∞∆°ng ph√°p th·ª±c h√†nh ƒë·ªÉ t√¨m ra h·∫°nh ph√∫c ƒë√≠ch th·ª±c cho ch√≠nh m√¨nh'
        }
      ];
    }
  }

  /* ========================================================================
   *  Mobile card renderer
   * ======================================================================*/
  function fillCards(data) {
    const container = $('#mobileCardContainer').empty();
    if (!data || !data.length) {
      container.html('<p style="text-align:center;padding:1.5rem;color:var(--text-muted)">Kh√¥ng t√¨m th·∫•y kh√≥a h·ªçc ph√π h·ª£p.</p>');
      return;
    }

    // D·ªØ li·ªáu cho cards gi·ªù ƒë√£ ƒë∆∞·ª£c l·ªçc tr∆∞·ªõc khi g·ªçi h√†m n√†y.
    // Ch·ªâ c·∫ßn s·∫Øp x·∫øp theo ng√†y b·∫Øt ƒë·∫ßu (g·∫ßn nh·∫•t ·ªü ƒë·∫ßu).
    const sortedData = [...data].sort((a, b) => {
      // H√†m chuy·ªÉn ƒë·ªïi DD/MM/YYYY th√†nh Date object
      const parseDate = (dateStr) => {
        if (!dateStr || dateStr.includes('--')) return new Date(0); // Ng√†y xa nh·∫•t n·∫øu kh√¥ng c√≥
        const [dd, mm, yyyy] = dateStr.split('/');
        return new Date(yyyy, mm - 1, dd); // mm - 1 v√¨ th√°ng trong JS b·∫Øt ƒë·∫ßu t·ª´ 0
      };

      const dateA = parseDate(a.start);
      const dateB = parseDate(b.start);

      // S·∫Øp x·∫øp tƒÉng d·∫ßn (ng√†y g·∫ßn nh·∫•t ·ªü ƒë·∫ßu)
      return dateA.getTime() - dateB.getTime();
    });

    const getModeBadgeClass = mode => {
      const online = /online|zoom|tr·ª±c tuy·∫øn/i.test(mode);
      const hybrid = /hybrid|k·∫øt h·ª£p/i.test(mode);
      return online ? 'online' : hybrid ? 'hybrid' : 'offline';
    };

    const getModeIcon = mode => {
      const online = /online|zoom|tr·ª±c tuy·∫øn/i.test(mode);
      const hybrid = /hybrid|k·∫øt h·ª£p/i.test(mode);
      return online ? 'fa-video' : hybrid ? 'fa-people-arrows' : 'fa-chalkboard-teacher';
    };

    container.html(sortedData.map(c => {
      const isSpecial = specialCourses.includes(c.course);
      const specialClass = isSpecial ? 'special-course-highlight' : '';

      const formatDM = d => {
        if (!d || d.includes('--')) return '??/??';
        const [dd, mm] = d.split('/');
        return `${dd}/${mm}`;
      };

      const dateDisplay = c.start === c.end
        ? formatDM(c.start)
        : `${formatDM(c.start)} - ${formatDM(c.end)}`;

      return `
      <article class="course-card">
        <div class="card-thumbnail-container">
          ${c.thumbnail ?
            `<img src="${c.thumbnail}" alt="${c.course}" class="card-thumbnail" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
             <div class="card-thumbnail-placeholder" style="display:none;">${c.course}</div>` :
            `<div class="card-thumbnail-placeholder">${c.course}</div>`
          }
        </div>

        <div class="card-header">
          <h3 class="card-title ${specialClass}">${c.course}</h3>
        </div>

        <div class="card-body">
          <div class="card-meta">
            <span class="card-mode-badge ${getModeBadgeClass(c.mode)}">
              <i class="fas ${getModeIcon(c.mode)}"></i>
              ${c.mode}
            </span>
          </div>

          <div class="card-info-grid">
            <div class="card-info-item">
              <i class="fas fa-user info-icon"></i>
              <span class="info-value">${c.speaker}</span>
            </div>
            <div class="card-info-item">
              <i class="fas fa-calendar info-icon"></i>
              <span class="info-value">${dateDisplay}</span>
            </div>
            <div class="card-info-item">
              <i class="fas fa-map-marker-alt info-icon"></i>
              <span class="info-value">${c.loc}</span>
            </div>
            ${c.categories ? `
            <div class="card-info-item">
              <i class="fas fa-tag info-icon"></i>
              <span class="info-value">${c.categories}</span>
            </div>` : ''}
          </div>

          <div class="card-price">${typeof c.fee === 'string' ? c.fee : VND(c.fee)}</div>

          ${c.description ? `<div class="card-description">${c.description}</div>` : ''}
        </div>

        <div class="card-footer">
          <a href="${c.href}" target="_blank" class="card-register-btn">ƒêƒÉng k√Ω ngay</a>
          <a href="${c.href}" target="_blank" class="card-details-btn">Chi ti·∫øt</a>
        </div>
      </article>`}).join(''));

    // Update mobile scroll indicator after cards are rendered
    if (window.updateMobileScrollIndicator) {
      setTimeout(window.updateMobileScrollIndicator, 100);
    }
  }

  /* ====== Debounce helper ====== */
  const debounce = (fn, ms = 250) => {
    let id;
    return (...args) => {
      clearTimeout(id);
      id = setTimeout(() => fn.apply(this, args), ms);
    };
  };

  /* ========================================================================
   *  Desktop Upcoming Highlights renderer
   * ======================================================================*/
  function renderHighlights(courseData){
    const container = $('#desktopHighlights').empty();
    if($(window).width()<1200) return; // only desktop

    const today = new Date();
    today.setHours(0, 0, 0, 0); // Set to start of day for accurate comparison
    const parseDate = (d)=>{ if(!d||d.includes('--')) return null; const [dd,mm,yy]=d.split('/'); return new Date(yy,mm-1,dd); };

    const groups = [
      {id:'hcm',label:'T·∫°i H·ªì Ch√≠ Minh',  match: c=>/H·ªì Ch√≠ Minh/i.test(c.loc)},
      {id:'hn', label:'T·∫°i H√† N·ªôi',   match: c=>/H√† N·ªôi/i.test(c.loc)},
      {id:'other',label:'T·ªânh/Th√†nh Ph·ªë Kh√°c', match: c=>!/(H·ªì Ch√≠ Minh|H√† N·ªôi|Zoom)/i.test(c.loc)},
      {id:'online',label:'Tr·ª±c Tuy·∫øn Qua Zoom', match: c=>/zoom/i.test(c.loc)}
    ];

    let htmls = [];
    groups.forEach(g=>{
      // D·ªØ li·ªáu cho highlights gi·ªù ƒë√£ ƒë∆∞·ª£c l·ªçc tr∆∞·ªõc, ch·ªâ c·∫ßn nh√≥m v√† s·∫Øp x·∫øp.
      const list = courseData
        .filter(c=>g.match(c))
        .sort((a,b)=>parseDate(a.start)-parseDate(b.start));

      const formatDM = d=>{const [dd,mm] = d.split('/'); return `${dd}/${mm}`};
      const items=list.map(c => {
        const specialClass = specialCourses.includes(c.course) ? 'special-course-highlight' : '';
        const dateDisplay = c.start === c.end ? formatDM(c.start) : `${formatDM(c.start)} ‚Äì ${formatDM(c.end)}`;
        return `<li><a href="${c.href}" target="_blank" class="course-name ${specialClass}">${c.course}</a><span class="course-date">${dateDisplay}</span></li>`;
      }).join('');

      // Special handling for "other" group to show location
      if (g.id === 'other') {
        const itemsWithLocation = list.map(c => {
          const specialClass = specialCourses.includes(c.course) ? 'special-course-highlight' : '';
          const dateDisplay = c.start === c.end ? formatDM(c.start) : `${formatDM(c.start)} ‚Äì ${formatDM(c.end)}`;
          return `<li>
            <div class="course-title-group">
              <a href="${c.href}" target="_blank" class="course-name ${specialClass}">${c.course}</a>
              <span class="course-location">(${c.loc})</span>
            </div>
            <span class="course-date">${dateDisplay}</span>
          </li>`;
        }).join('');
        const tileContent = `
          <article id="tile-${g.id}" class="upcoming-tile">
            <h3>${g.label}</h3>
            <div class="tile-divider"></div>
            <ul>${itemsWithLocation || '<li>ƒêang c·∫≠p nh·∫≠t‚Ä¶</li>'}</ul>
          </article>`;
        htmls.push(tileContent);
      } else {
        htmls.push(`
          <article id="tile-${g.id}" class="upcoming-tile">
            <h3>${g.label}</h3>
            <div class="tile-divider"></div>
            <ul>${items || '<li>ƒêang c·∫≠p nh·∫≠t‚Ä¶</li>'}</ul>
          </article>`);
      }
    });
    container.html(htmls.join(''));
  }

  /* ========================================================================
   *  Init
   * ======================================================================*/
  $(async () => {
    const allCourseData = await getData();

    // L·ªçc tr∆∞·ªõc t·∫•t c·∫£ d·ªØ li·ªáu ƒë·ªÉ ch·ªâ hi·ªÉn th·ªã c√°c kh√≥a h·ªçc ch∆∞a k·∫øt th√∫c (end_date >= today)
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    const parseDateForFilter = (dateStr) => {
        if (!dateStr || dateStr.includes('--')) return null;
        const [dd, mm, yyyy] = dateStr.split('/');
        return new Date(yyyy, mm - 1, dd);
    };
    const courseData = allCourseData.filter(course => {
      const endDate = parseDateForFilter(course.end);
      // Gi·ªØ l·∫°i kh√≥a h·ªçc n·∫øu ng√†y k·∫øt th√∫c c·ªßa n√≥ l·ªõn h∆°n ho·∫∑c b·∫±ng h√¥m nay
      return endDate ? endDate.getTime() >= today.getTime() : false;
    });

    fillCards(courseData);
    renderHighlights(courseData);

    // Initialize mobile scroll indicator
    initMobileScrollIndicator();

    const dt = $('#courses').DataTable({
      data: courseData,
      columns: [
        { data: 'course' },
        { data: 'speaker' },
        { data: null }, // Placeholder for the combined date range
        { data: 'loc' },
        { data: 'mode' },
        { data: 'start', visible: false }, // Hidden column for sorting
        { data: 'end', visible: false } // Hidden column
      ],
      columnDefs: [
        {
          targets: 2, // The new "Th·ªùi gian" column
          orderData: [5], // Sort this column using the 'start' date data (index 5)
          render: function (data, type, row) {
            const formatDM = d => {
              if (!d || d.includes('--')) return '??/??';
              const [dd, mm] = d.split('/');
              return `${dd}/${mm}`;
            };
            return row.start === row.end
              ? formatDM(row.start)
              : `${formatDM(row.start)} - ${formatDM(row.end)}`;
          }
        },
        { type: 'ddmmyyyy', targets: [5] }, // Apply date sorting to the hidden start column
        {
          targets: 3, /* ƒê·ªãa ƒëi·ªÉm: now at index 3 */
          render: (data) => `${data} ${/^\+?\d/.test(data.trim()) ? `<a href="tel:${data.trim()}" class="phone-link" title="G·ªçi ƒëi·ªán"><i class="fas fa-phone"></i></a>` : ''}`
        },
        { targets: 4, render: (d) => createModeBadge(d) } /* H√¨nh th·ª©c: now at index 4 */
      ],
      createdRow: (row, data) => {
        $(row).attr('data-href', data.href);
        if (specialCourses.includes(data.course)) {
          $('td:eq(0)', row).addClass('special-course-highlight');
        }
      },
      order: [[2, 'asc']], // Sort by the new "Th·ªùi gian" column
      pageLength: -1, // Hi·ªÉn th·ªã t·∫•t c·∫£ entries
      lengthMenu: [], // ·∫®n menu length
      dom: 'rt', // Ch·ªâ hi·ªÉn th·ªã table v√† processing
      info: false, // ·∫®n th√¥ng tin s·ªë l∆∞·ª£ng entries
      paging: false, // ·∫®n ph√¢n trang
      autoWidth: false,
      initComplete: function() {
        const isDesktop = window.innerWidth > 1200;
        const topValue = isDesktop ? '0px' : '80px';

        $('#courses thead th').css({
          'position': 'sticky',
          'top': topValue,
          'z-index': '50',
          'background': '#2EC7BE', /* M√†u xanh ng·ªçc nh·∫°t */
          'box-shadow': '0 2px 2px -1px rgba(0, 0, 0, 0.4)'
        });
      },
      drawCallback: function() {
        const isDesktop = window.innerWidth > 1200;
        const topValue = isDesktop ? '0px' : '80px';

        $('#courses thead th').css({
          'position': 'sticky',
          'top': topValue,
          'z-index': '50',
          'background': '#2EC7BE' /* M√†u xanh ng·ªçc nh·∫°t */
        });
      }
    });

    /* ‚ñ∏ Global search: b·ªè d·∫•u + ƒë·ªìng b·ªô hai view */
    $('#globalSearch').on('input', debounce(function () {
      dt.search('').draw(); // X√≥a t√¨m ki·∫øm m·∫∑c ƒë·ªãnh ƒë·ªÉ s·ª≠ d·ª•ng plugin t√πy ch·ªânh
    }));

    /* ‚ñ∏ Handle resize for sticky positioning */
    $(window).on('resize', debounce(function() {
      const isDesktop = window.innerWidth > 1200;
      const topValue = isDesktop ? '0px' : '80px';

      $('#courses thead th').css('top', topValue);
      $('.dataTables_scrollHead').css('top', topValue);
    }, 250));

    dt.on('draw.dt', () => {
      fillCards(dt.rows({ search: 'applied' }).data().toArray());
      // Update scroll indicator after cards are refreshed
      if (window.updateMobileScrollIndicator) {
        setTimeout(window.updateMobileScrollIndicator, 100);
      }
    });

    /* ‚ñ∏ row click to open */
    $('#courses tbody').on('click', 'tr', function (e) {
      if ($(e.target).closest('a').length) return; /* avoid when clicking phone icon */
      const href = $(this).data('href');
      if (href && href !== '#') window.open(href, '_blank');
    });

    /* ========================================================================
     *  Mobile Scroll Indicator Logic
     * ======================================================================*/
    function initMobileScrollIndicator() {
      const $indicator = $('#mobileScrollIndicator');
      const $mobileContainer = $('#mobileCardContainer');
      let isIndicatorVisible = false;
      let hideTimeout;

      // Ki·ªÉm tra xem c√≥ ph·∫£i mobile view kh√¥ng
      function isMobileView() {
        return window.innerWidth <= 1200;
      }

      // Ki·ªÉm tra xem c√≥ ƒë·ªß n·ªôi dung ƒë·ªÉ scroll kh√¥ng
      function hasScrollableContent() {
        return document.documentElement.scrollHeight > window.innerHeight + 100; // Th√™m buffer 100px
      }

      // Ki·ªÉm tra xem ƒë√£ scroll g·∫ßn ƒë·∫øn cu·ªëi ch∆∞a
      function isNearBottom() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const windowHeight = window.innerHeight;
        const documentHeight = document.documentElement.scrollHeight;
        const distanceFromBottom = documentHeight - (scrollTop + windowHeight);

        // ·∫®n indicator khi c√≤n c√°ch ƒë√°y 150px
        return distanceFromBottom <= 150;
      }

      // Hi·ªÉn th·ªã indicator v·ªõi animation smooth
      function showIndicator() {
        if (isIndicatorVisible) return;

        $indicator.removeClass('hiding').addClass('visible');
        isIndicatorVisible = true;

        // Clear any existing hide timeout
        if (hideTimeout) {
          clearTimeout(hideTimeout);
          hideTimeout = null;
        }
      }

      // ·∫®n indicator v·ªõi animation smooth
      function hideIndicator() {
        if (!isIndicatorVisible) return;

        $indicator.removeClass('visible').addClass('hiding');
        isIndicatorVisible = false;

        // Ho√†n to√†n ·∫©n element sau khi animation k·∫øt th√∫c
        hideTimeout = setTimeout(() => {
          $indicator.removeClass('hiding');
        }, 300); // Match v·ªõi animation duration
      }

      // Main logic ƒë·ªÉ quy·∫øt ƒë·ªãnh hi·ªÉn th·ªã/·∫©n indicator
      function updateIndicatorVisibility() {
        if (!isMobileView()) {
          hideIndicator();
          return;
        }

        // Ch·ªâ hi·ªÉn th·ªã khi:
        // 1. ƒêang ·ªü mobile view
        // 2. C√≥ ƒë·ªß n·ªôi dung ƒë·ªÉ scroll
        // 3. Ch∆∞a scroll g·∫ßn ƒë·∫øn cu·ªëi
        // 4. Mobile container c√≥ cards
        if (hasScrollableContent() && !isNearBottom() && $mobileContainer.children().length > 0) {
          showIndicator();
        } else {
          hideIndicator();
        }
      }

      // Throttle scroll events ƒë·ªÉ optimize performance
      let scrollTimeout;
      function throttledScrollHandler() {
        if (scrollTimeout) return;

        scrollTimeout = setTimeout(() => {
          updateIndicatorVisibility();
          scrollTimeout = null;
        }, 16); // ~60fps
      }

      // Event listeners
      $(window).on('scroll', throttledScrollHandler);
      $(window).on('resize', debounce(updateIndicatorVisibility, 250));

      // Initial check
      updateIndicatorVisibility();

      // Expose update function globally ƒë·ªÉ c√≥ th·ªÉ g·ªçi t·ª´ b√™n ngo√†i
      window.updateMobileScrollIndicator = updateIndicatorVisibility;
    }
  });
</script>
</body>
</html>
